Планировщик и сплайнер
======================

Look-ahead планировщик анализирует очередь сегментов, вычисляя допустимые
скорости на границах с учётом ограничений по скорости, ускорению и рывку. Для
сплайнов используется метод добавочного time-scaling Shin–McKay. В документации
приведены основные формулы, реализованные в коде.

Дополнительно встроенный TinyML оптимизатор анализирует кривизну, длину дуги и
номинальные ограничения, выдавая корректирующий множитель скорости перед
генерацией S-кривой. Нейросеть представляет собой однослойный персептрон в
фиксированной точности Q16.16, что позволяет запускать инференс в каждом цикле
без динамических аллокаций.

Модуль :c:func:`gcode_parse_line` поддерживает полный набор команд рабочего
профиля станка: модальные переключения G20/G21 и G90/G91, линейные перемещения
G0/G1, дуги G2/G3 с радиусом или IJK, выдержки G4, а также сплайны G5/G5.2 для
кубических Безье и рациональных NURBS. Параметры подаются в формате мм или
дюймов, автоматически конвертируются в Q16.16 и передаются в планировщик через
:c:func:`planner_enqueue_spline`. Для отладки :c:func:`gcode_parser_last_report`
возвращает человекочитаемое описание последней обработанной команды.
