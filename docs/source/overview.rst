Обзор архитектуры
=================

Система разделена на подсистемы, соответствующие директориям исходного кода.
`/core` отвечает за конечный автомат ЧПУ, `/planner` реализует look-ahead и
jerk-limited S-кривые, `/planner/splines` содержит геометрию сплайнов.
`/kinematics` описывает прямую и обратную задачи дельта-робота и матрицу Якоби.

Компоненты взаимодействуют через интерфейсы, определённые в соответствующих
заголовках. Все публичные функции снабжены Doxygen-комментариями и примерами
использования, а документация генерируется автоматически.

Основной процесс управления запускается в отдельном реальном времени процессе,
тогда как OPC UA сервер, симулятор и аналитика выполняются во вспомогательных
процессах. Такая изоляция позволяет сохранять жёсткий цикл 1 кГц даже при
добавлении OPC UA, визуализации или калибровки.

Подсистема `vision` обеспечивает синтетическое машинное зрение для калибровки и
контроля. Расчитанные ошибки выравнивания публикуются в OPC UA адресном
пространстве и доступны для IDE/симулятора. EtherCAT мастер читает XML описания
приводов (например, экспортированные из KEBA), что облегчает миграцию существующих
роботов без ручного ввода параметров.

При необходимости планировщик расширяется брахистохронным решателем, который по
команде конфигурации ``--enable-brachisto`` генерирует циклоидальные траектории
минимального времени между двумя точками, автоматически интегрируя их в очередь
look-ahead и систему аддитивного time-scaling.

Модуль `gcode` реализует полноценный интерпретатор G-кода с поддержкой дуг,
сплайнов и модальных состояний, конвертирующий команды в сплайны, подаваемые в
планировщик. Среда разработки `ide` дополнительно компилирует программы IEC
61131-3 Structured Text в C и формирует метаданные для подсветки синтаксиса и
автодополнения, а также экспортирует CSV-трассу углов дельта-приводов для
постобработки.
